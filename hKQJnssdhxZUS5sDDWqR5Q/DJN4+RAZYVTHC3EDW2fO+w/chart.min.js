function changeScreens(){var t=document.getElementById("screen1"),e=document.getElementById("screen2"),a=document.getElementById("move");"inline"==t.style.display?(t.style.display="none",e.style.display="inline",a.value="Previous Screen"):(t.style.display="inline",e.style.display="none",a.value="Next Screen")}function getList(t){var e=0;input=document.getElementsByClassName(t);for(var a=0;a<input.length;a++)""==input[a].value&&e++;if(e==input.length)throw new Error("No input values for X, nothing to be drawn.");"x"==t||"x2"==t?x=copy(input):"y"!=t&&"y2"!=t||(y=copy(input))}function copy(t){for(var e=[],a=0;a<t.length;a++)""!=t[a].value&&(e[a]=parseFloat(t[a].value));return e}function getMaximumValue(t){for(var e=-99999,a=0;a<t.length;a++)t[a]>=e&&(e=t[a]);return e}function getMinimumValue(t){for(var e=99999,a=0;a<t.length;a++)t[a]<=e&&(e=t[a]);return e}function s1Input(){clearGraph("visualisation"),getList("x"),getList("y"),sumX=sum(x),sumY=sum(y),sumX2=multiplySum(x,x),sumXY=multiplySum(x,y),sumY2=multiplySum(y,y),slope=(x.length*sumXY-sumX*sumY)/(x.length*sumX2-sumX*sumX),intercept=(sumY-slope*sumX)/x.length,lineX2=getMaximumValue(x),lineX1=getMinimumValue(x),maxY=getMaximumValue(y),lineY1=regression(0),lineY2=regression(lineX2);for(var t=0;t<x.length;t++)dataset.push([x[t],y[t]]);count=x.length==y.length?x.length:alert("X and Y list does not match!"),InitChart()}function oxygenDeficit(){var t=parseFloat(vo2max*workrate/100*180);console.log("Overall: "+t);for(var e=0,a=0;a<y.length;a++)e+=barwidth*y[a];console.log("Oxygen Consumed: "+e);var n=(t-e)/(60/barwidth);console.log("Deficit "+n);var r=1e3*n;console.log("rval : "+r),maod=r/bodyMass}function s2Input(){reqSpeed(),clearGraph("visualisation2"),getList("x2"),getList("y2");for(var t=0;t<x.length;t++)dataset[t]={x:x[t],y:y[t]};secondGraph()}function multiplySum(t,e){for(var a=0,n=0;n<t.length;n++)a+=t[n]*e[n];return a}function sum(t){for(var e=0,a=0;a<t.length;a++)e+=parseFloat(t[a]);return e}function regression(t){return slope*t+intercept}function secondGraph(){var t={top:20,right:20,bottom:20,left:50},e=700-t.left-t.right,a=500-t.top-t.bottom,n=d3.scale.linear().domain([0,180]).range([0,e]),r=d3.scale.linear().domain([0,8]).range([a,0]),l=d3.select("#visualisation2").append("svg:svg").attr("width",e+t.right+t.left).attr("height",a+t.top+t.bottom).attr("class","chart").append("g").attr("transform","translate("+t.left+","+t.top+")").attr("width",e).attr("height",a).attr("class","main"),s=d3.svg.axis().scale(n).orient("bottom").ticks(5).tickValues(d3.range(0,e,15));l.append("g").attr("transform","translate(0,"+a+")").attr("class","main axis date").call(s);var i=d3.svg.axis().scale(r).orient("left");l.append("g").attr("transform","translate(0,0)").attr("class","main axis date").call(i);var o=l.append("svg:g");o.selectAll(".bar").data(dataset).enter().append("rect").attr("class","bar").attr("x",function(t){return n(t.x-barwidth)}).attr("y",function(t){return r(t.y)}).attr("width",e/interval).attr("height",function(t){return a-r(t.y)});var u=[{x:0,y:vo2max*workrate/100},{x:180,y:vo2max*workrate/100}],d=d3.svg.line().x(function(t){return n(t.x)}).y(function(t){return r(t.y)}).interpolate("linear");o.append("svg:path").attr("d",d(u)).attr("stroke","red").attr("stroke-width",2).attr("fill","none"),o.append("text").attr("transform","translate(5,"+r(u[1].y+.2)+")").attr("dy",".35em").attr("text-anchor","start").style("fill","red").text("Oxygen Required "+vo2max*workrate/100+" (L/min)"),oxygenDeficit(),$("#results2").text("MOAD: "+maod),$("#dataswap2").text("Time Interval (s)"),$("#datawrap2").text("V02 Max (L/Min)")}function InitChart(){var t={top:20,right:20,bottom:20,left:50},e=700-t.left-t.right,a=500-t.top-t.bottom,n=[{x:0,y:lineY1},{x:lineX2,y:lineY2}],r=dataset,e=700-(t={top:20,right:20,bottom:20,left:50}).left-t.right,a=500-t.top-t.bottom,l=d3.scale.linear().domain([0,lineX2+5]).range([0,e]),s=d3.scale.linear().domain([0,5]).range([a,0]),i=d3.select("#visualisation").append("svg:svg").attr("width",e+t.right+t.left).attr("height",a+t.top+t.bottom).attr("class","chart").append("g").attr("transform","translate("+t.left+","+t.top+")").attr("width",e).attr("height",a).attr("class","main"),o=d3.svg.axis().scale(l).orient("bottom");i.append("g").attr("transform","translate(0,"+a+")").attr("class","main axis date").call(o);var u=d3.svg.axis().scale(s).orient("left");i.append("g").attr("transform","translate(0,0)").attr("class","main axis date").call(u);var d=i.append("svg:g");d.selectAll("scatter-dots").data(r).enter().append("svg:circle").attr("cx",function(t,e){return l(t[0])}).attr("cy",function(t){return s(t[1])}).attr("r",5,5).append("svg:title").text(function(t){return t});var p=d3.svg.line().x(function(t){return l(t.x)}).y(function(t){return s(t.y)}).interpolate("linear");d.append("svg:path").attr("d",p(n)).attr("stroke","red").attr("stroke-width",2).attr("fill","none").append("svg:title").text(function(t){return"Y-Intercept: "+intercept+", Slope: "+slope}),$("#results").text("Y-Intercept: "+Math.round(1e4*intercept)/1e4+", X-Intercept: "+Math.round(-intercept/slope*1e4)/1e4+", Slope: "+Math.round(1e4*slope)/1e4+", R^2: "+correlation()+", Equation: Y = "+Math.round(1e4*slope)/1e4+"X + "+Math.round(1e4*intercept)/1e4),$("#dataswap").text("Workload"),$("#datawrap").text("V02 Max (L/Min)")}function correlation(){var t=0,e=count*sumXY-sumX*sumY,a=Math.sqrt((count*sumX2-Math.pow(sumX,2))*(count*sumY2-Math.pow(sumY,2)));return t=Math.pow(e/a,2),(t=Math.round(1e3*t)/1e3)<.8&&alert("Please review the data you entered, it seems a bit off."),t}function clearGraph(t){console.log("#"+t),$("#"+t).empty(),xInput=0,yInput=0,x=[],y=[],ny=0,nx=0,count=0,sumX=0,sumY=0,sumY2=0,sumX2=0,sumXY=0,xFinal=[],yFinal=[],lineY1=0,lineY2=0,lineX1=0,lineX=0,dataset=[],$("#dataswap").text(""),$("#datawrap").text(""),$("#dataswap2").text(""),$("#datawrap2").text("")}function kk(t){var e=document.getElementsByClassName("x2"),a=document.getElementsByClassName("y2");barwidth=parseInt(t),interval=180/barwidth;for(var n=0;n<=interval;n++)e[n].style.display="inline",a[n].style.display="inline",e[n].value=(n+1)*t;for(var r=interval;r<=e.length;r++)e[r].style.display="none",a[r].style.display="none"}function setName(t){document.getElementById("officialname").innerHTML="Patient Name: "+t+"<input name='submitMedical' value='' title='edit client details' class='profile_edit_btn' type='submit' />"}function setMass(t){bodyMass=parseFloat(t)}function reqSpeed(){vo2max=parseFloat(document.getElementById("Vmax").value),workrate=parseFloat(document.getElementById("supermaximal").value),reqwork=(vo2max*workrate/100-intercept)/slope,document.getElementById("reqworkload").value=reqwork}var xInput,yInput,x=[],y=[],ny=0,nx=0,count,sumX=0,sumY=0,sumY2,sumX2,sumXY,slope=0,intercept,xFinal=[],yFinal=[],lineY1,lineY2,lineX1,lineX,dataset=[],interval,barwidth,vo2max,workrate,oxygenRequired,bodyMass,maod=0;